/*! jquery.minimap 2013-10-29 */
!function(a){a.fn.minimap=function(b){var b=a.extend({body_col:"",map_col:"",toggle_btn:"",draggable:"undefined"!=typeof a.fn.draggable,scrollto:"undefined"!=typeof a.fn.scrollTo,map_header:""},b),c=b.body_col?a(b.body_col):a(this),d=b.map_col?a(b.map_col):a('<aside class="map_col"></aside>'),e=a(b.map_header).appendTo(d);d.insertBefore(c);var f=!1,g=!1,h=!1;!function(){if(!f){console.log(d);var b,i=d,j=i.outerHeight(),k=e?e.outerHeight():0,l=i.outerWidth(),m=c,n=m.outerHeight(),o=a(".body_col").width()-l,p=Math.min((l-12)/o,(j-24)/n),q=a("<div></div>").addClass("map-col-background").css({position:"fixed",width:l-1,height:j,top:k,overflow:"hidden"}).appendTo(i),r=m.clone(!1).css({background:"transparent",color:"black",width:o,position:"absolute",top:"6px",right:(l-p*o)/2,opacity:"1",transform:"scale("+p+")","-ms-transform":"scale("+p+")","-webkit-transform":"scale("+p+")","transform-origin":"top right","-ms-transform-origin":"top right","-webkit-transform-origin":"top right"});r.find("script").remove(),r.appendTo(q),miniMapOverlay=a("<div></div>").css({width:"100%",height:"100%",position:"absolute",top:0,left:0}).addClass("mini-map-clickable").appendTo(q),b=a('<div class="miniMapOverlay ui-draggable"></div>').css({background:"rgba(26, 45, 58, .1)",width:"100%",position:"absolute"}).appendTo(q),a(window).on("resize.minimap",function(){h||(h=!0,n=m.height(),o=m.width(),j=i.outerHeight(),l=i.outerWidth(),k=e?e.height():0,winHeight=a(window).height(),p=Math.min((l-12)/o,(j-24)/n),q.css({width:l-1,height:j}),r.css({width:o,right:(l-p*o)/2,transform:"scale("+p+")","-ms-transform":"scale("+p+")","-webkit-transform":"scale("+p+")","transform-origin":"top right","-ms-transform-origin":"top right","-webkit-transform-origin":"top right"}),a(window).trigger("scroll.minimap"),h=!1)}),a(window).on("scroll.minimap",function(){if(!g){g=!0;var c=a(window).scrollTop(),d=a(window).height();b.css({top:c*p+6,height:d*p}),g=!1}}),f=!0,a(".miniMapOverlay").draggable({axis:"y",containment:"parent",drag:function(b,c){var d=parseFloat(a(c.helper).css("top"))-6;a(window).scrollTop(d/p)}}),a(".mini-map-clickable").click(function(b){var c=b.clientY-a(".map_col").offset().top-60,d=(a(window).height()-k)*p;clickCenter=Math.max(0,c-d/2),a(window).scrollTop(clickCenter/p)})}}(),a(window).load(function(){i.toggle(window.localStorage.getItem("miniMapActive"))});var i={toggle:function(b){if("undefined"==typeof b){var c=window.localStorage.getItem("miniMapActive");b=!(c&&"false"!==c)}b?a("body").addClass("mini-map-active"):a("body").removeClass("mini-map-active"),localStorage.setItem("miniMapActive",b),a(window).trigger("resize.minimap")},show:function(){return this.toggle(!0)},hide:function(){return this.toggle(!1)}};a.minimap=this,a.extend(a.minimap,i)}}(jQuery);